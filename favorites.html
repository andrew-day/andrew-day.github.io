
<!DOCTYPE html>

<!-- paulirish.com/2008/conditional-stylesheets-vs-css-hacks-answer-neither/ --> 
<!--[if lt IE 7 ]> <html lang="en" class="no-js ie6"> <![endif]-->
<!--[if IE 7 ]>    <html lang="en" class="no-js ie7"> <![endif]-->
<!--[if IE 8 ]>    <html lang="en" class="no-js ie8"> <![endif]-->
<!--[if IE 9 ]>    <html lang="en" class="no-js ie9"> <![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html lang="en" class="no-js"> <!--<![endif]-->
<head>
    <meta charset="utf-8">

         <!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame 
       Remove this if you use the .htaccess -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <title>Momentous moments</title>
  <meta name="description" content="Design portfolio and travel catalogue">
  <meta name="keywords" content="Andrew Day, design, interactive design, integrated marketing, identity, and advertising, Chicago, Illinois, USA"  /> 
  <meta name="author" content="Andrew Day">

  <!--  Mobile viewport optimized: j.mp/bplateviewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Place favicon.ico & apple-touch-icon.png in the root of your domain and delete these references -->
  <link rel="shortcut icon" href="favicon.png">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">


        <script src="http://cdn.kendostatic.com/2012.1.322/js/jquery.min.js" type="text/javascript"></script>
        <script src="http://cdn.kendostatic.com/2012.1.322/js/kendo.web.min.js" type="text/javascript"></script>
        <link href="http://cdn.kendostatic.com/2012.1.322/styles/kendo.common.min.css" rel="stylesheet" type="text/css" />
        <link href="http://cdn.kendostatic.com/2012.1.322/styles/kendo.default.min.css" rel="stylesheet" type="text/css" />


  <!-- CSS : implied media="all" -->
  <link rel="stylesheet" href="css/main.css">


  <!-- Uncomment if you are specifically targeting less enabled mobile browsers
  <link rel="stylesheet" media="handheld" href="css/handheld.css?v=2">  -->
 
  <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects -->
  <script src="js/libs/modernizr-1.6.min.js"></script>
<script type="text/javascript" src="http://use.typekit.com/kjy5jrw.js"></script>
<script type="text/javascript">try{Typekit.load();}catch(e){}</script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-9094053-1', 'auto');
  ga('send', 'pageview');

</script>



        <style>
        
#container { padding-bottom:0 !important }

.horiz { display:block; width:100%; overflow-x:scroll; height:150px; margin-top:20px; }

ul.scrolly { width:8000px; }

ul.scrolly li { width:auto !important; margin:0; padding:0; border:none; float:left; display:inline; margin-right:5px; }

ul.scrolly li img { width:auto; height:100px; -webkit-filter: grayscale(75%); }
ul.scrolly li img:hover { -webkit-filter: grayscale(0%); }


ul.scrolly li h3 { position:absolute; display:none; font-size:14px; margin-top:-40px; }
ul.scrolly li:hover h3 { display:inline; z-index:100; }


        </style>
                
                
    </head>
    
    
    <body>
    

<!-- Google Tag Manager -->
<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-P26KTV"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-P26KTV');</script>
<!-- End Google Tag Manager -->


    
<div id="container">
  
<header>

<nav>
<ul>
<li class="first"><a href="index.html">Viewfinder</a></li>
<li class="selected">Faves</li>
<li><a href="chronology.html">Itineraries</a></li>
<li><a href="map.html">Atlas</a></li>
<li><a href="scrapbook.html">S-crap-book</a></li>
<li class="last"><a href="http://design.andrewday.com/">Design & UX →</a></li>
</ul>
</nav>



<h1>momentous moments</h1>
  

</header>



<nav class="horiz">

<ul class="scrolly">


<li>w.i.p.</li>



<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157639955273775/show/"><img src="http://farm8.staticflickr.com/7339/12044547326_d83c55ff72_m.jpg"  alt="2014 · Elise Gabrielle Day" /></a>
<h3>Elise Gabrielle Day</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157639957122954/show/"><img src="http://farm4.staticflickr.com/3735/12043958293_ab03f2dde9_m.jpg"  alt="2014 · Randoms" /></a>
<h3>Random</h3>
</li>


<li>2013</li>


<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157633015007196/show/"><img src="http://farm6.staticflickr.com/5513/11921089774_39b9203535_m.jpg"  alt="2013 · Elise Gabrielle Day" /></a>
<h3>Elise Gabrielle Day</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157632406338125/show/"><img src="http://farm9.staticflickr.com/8333/8421820753_f1cb7c9a9a_m.jpg"  alt="2013 · Randoms" /></a>
<h3>Random</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157639156171535/show/"><img src="http://farm3.staticflickr.com/2811/11627787046_679ff6859e_z.jpg"  alt="2013 · Mexico · Loreto, San José del Cabo" /></a>
<h3><span class="co">MX</span>Loreto, San José del Cabo</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157639152844346/show/"><img src="http://farm4.staticflickr.com/3710/11617541445_6f74c5a070_m.jpg"  alt="2013 · Mexico · La Paz, San José del Cabo" /></a>
<h3><span class="co">MX</span>La Paz, San José del Cabo</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157635357086563/show/"><img src="http://farm6.staticflickr.com/5535/9695673298_6d145cdea6_m.jpg"  alt="2013 · Detroit" /></a>
<h3>Beachtown & Motown</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157633475511289/show/"><img src="http://farm8.staticflickr.com/7282/8737283004_e1499d6f76_m.jpg"  alt="2013 · Michconsin" /></a>
<h3>Michconsin</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157633339259663/show/"><img src="http://farm9.staticflickr.com/8257/8682950580_a9a707e342_m.jpg"  alt="2013 · Seattle" /></a>
<h3>Seattle</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157633184005959/show/"><img src="http://farm9.staticflickr.com/8053/8355897857_6cc371b3ee_m.jpg"  alt="2013 · Michigan" /></a>
<h3>Michigan</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157632587310001/show/"><img src="http://farm9.staticflickr.com/8085/8407801094_de790b2592.jpg"  alt="2013 · Mexico · Pacific Coast" /></a>
<h3><span class="co">MX</span>Pacific Coast</h3>
</li>



<li>2012</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157628785176155/show/"><img src="http://farm7.staticflickr.com/6226/6852775426_22f6c18f65_m.jpg"  alt="2012 · Randoms" /></a>
<h3>Random</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157631680492333/show/"><img src="http://farm9.staticflickr.com/8460/8049283955_9160cd46c1_m.jpg"  alt="2012 · Mexico · Mexico City" /></a>
<h3><span class="co">MX</span>Mexico City</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630438170192/show/"><img src="http://farm9.staticflickr.com/8003/7510534390_8de76c3d8b_m.jpg"  alt="2012 · Spain · Barcelona" /></a>
<h3><span class="co">ES</span>Barcelona, Montserrat</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630458762542/show/"><img src="http://farm9.staticflickr.com/8016/7518634400_1554799610_m.jpg"  alt="2012 · Morocco ·  Casablanca" /></a>
<h3><span class="co">MA</span>Casablanca</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630391061854/show/"><img src="http://farm8.staticflickr.com/7128/7492080770_1be37526fb_m.jpg"  alt="2012 · Morocco · Fès, Meknes, Volubilis" /></a>
<h3><span class="co">MA</span>Fès, Meknes, Volubilis</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630521589868/show/"><img src="http://farm8.staticflickr.com/7126/7547412404_a5ea0ebd9a_m.jpg"  alt="2012 · Morocco · Marrakech, Atlas Mountains" /></a>
<h3><span class="co">MA</span>Marrakech, Atlas Mountains</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630456451134/show/"><img src="http://farm8.staticflickr.com/7120/7517768346_5f6cb430ff_m.jpg"  alt="2012 · Spain, Morocco · Tarifa, Tangier" /></a>
<h3><span class="co">ES+MA</span>Tarifa, Tangier</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630580654494/show/"><img src="http://farm8.staticflickr.com/7252/7572783004_072b98c56c_n.jpg"  alt="2012 · Gibraltar · Wedding" /></a>
<h3><span class="co">GI</span>Wedding</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630453363818/show/"><img src="http://farm9.staticflickr.com/8026/7516920484_f3bf7f3392.jpg"  alt="2012 · Gibraltar · Gibraltar, Algeciras" /></a>
<h3><span class="co">GI</span>Gibraltar, Algeciras</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630675905788/show/"><img src="http://farm9.staticflickr.com/8015/7689436592_27c117e65b_m.jpg"  alt="2012 · Spain · Toledo, Cuenca" /></a>
<h3><span class="co">ES</span>Toledo, Cuenca</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630473513196/show/"><img src="http://farm8.staticflickr.com/7279/7525155452_ce1e329181.jpg"  alt="2012 · Portugal · Sagres, Costa Vicentina, Vila Nova de Milfontes" /></a>
<h3><span class="co">PT</span>Sagres, Costa Vicentina, Vila Nova de Milfontes</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630574120574/show/"><img src="http://farm8.staticflickr.com/7119/7569443630_92aaf73e69_m.jpg"  alt="2012 · Portugal · Evora" /></a>
<h3><span class="co">PT</span>Evora</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630565481358/show/"><img src="http://farm8.staticflickr.com/7264/7568319532_36b6f3eb96_m.jpg"  alt="2012 · Portugal · Nazaré, Alcobaça, Batalha, Tomar, Óbidos" /></a>
<h3><span class="co">PT</span>Nazaré, Alcobaça, Batalha, Tomar, Óbidos</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630565051396/show/"><img src="http://farm8.staticflickr.com/7127/7560182600_c65e038c26_m.jpg"  alt="2012 · Portugal · Coimbra, Serra de Estrela, Piódão" /></a>
<h3><span class="co">PT</span>Coimbra, Serra de Estrela, Piódão</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630459199808/show/"><img src="http://farm9.staticflickr.com/8142/7520984068_d701375c72.jpg"  alt="2012 · Portugal · Douro Valley, Parque Alvão" /></a>
<h3><span class="co">PT</span>Douro Valley, Parque Alvão</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630428951646/show/"><img src="http://farm9.staticflickr.com/8020/7505975106_85347c8774_n.jpg"  alt="2012 · Portugal · Porto" /></a>
<h3><span class="co">PT</span>Porto</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630381477712/show/"><img src="http://farm8.staticflickr.com/7278/7484743662_05f19325a5.jpg"  alt="2012 · Portugal · Lisbon, Sintra" /></a>
<h3><span class="co">PT</span>Lisbon, Sintra</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630675997196/show/"><img src="http://farm9.staticflickr.com/8290/7671324194_d80306f9b0_n.jpg"  alt="2012 · Spain · Salamanca, La Alberca, Ávila" /></a>
<h3><span class="co">ES</span>Segovia, Ávila, Sepúlveda</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630598490038/show/"><img src="http://farm9.staticflickr.com/8293/7671184264_bae2f8d477_m.jpg"  alt="2012 · Spain · León, Oviedo, Salamanca, La Alberga" /></a>
<h3><span class="co">ES</span>León, Oviedo, Salamanca, La Alberga</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630398803322/show/"><img src="http://farm9.staticflickr.com/8284/7494593630_7ec5245415.jpg"  alt="2012 · Spain · Picos de Europa" /></a>
<h3><span class="co">ES</span>Picos de Europa</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630490626966/show/"><img src="http://farm9.staticflickr.com/8290/7533218388_cb7e73f93a_m.jpg"  alt="2012 · Spain · San Sebastian, Bilbao, Castillana" /></a>
<h3><span class="co">ES</span>San Sebastian, Bilbao, Castillana</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630441061562/show/"><img src="http://farm8.staticflickr.com/7258/7512594244_d62a5396ef_n.jpg"  alt="2012 · Spain · La Rioja, Olite, Pamplona" /></a>
<h3><span class="co">ES</span>La Rioja, Olite, Pamplona</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157630390276922/show/"><img src="http://farm9.staticflickr.com/8024/7488654256_5eaaf71d45_m.jpg"  alt="2012 · Spain · Madrid" /></a>
<h3><span class="co">ES</span>Madrid</h3>
</li>

<li>
<a href="http://www.flickr.com/photos/andrewday/sets/72157628134685414/show/"><img src="http://farm8.staticflickr.com/7146/6729215267_559b88c429_m.jpg"  alt="2012 · Canada · Quebec City, Toronto" /></a>
<h3><span class="co">CA</span>Quebec City, Toronto</h3>
</li>



</ul>
</nav>






<div id="picmenu">

        <select class="k-select" id="tags">

            <option value="asdfave" selected>All</option>
            <option></option>

        <optgroup label="Adventures">
            <option value="asdfave,mexico">2012 · Mexico</option>
            <option value="asdfave,ad2012iberiaroc2">2012 · Gibraltar, Morocco, Spain</option>
            <option value="asdfave,ad2012giwedding">2012 · Gibraltar wedding</option>
            <option value="asdfave,ad2012iberiaroc1">2012 · Spain, Portugal</option>
            <option value="asdfave,ad2011oktoberfrance">2011 · France, Italy, Switzerland</option>
            <option value="asdfave,ad2011amsterparis">2011 · Netherlands, France</option>
            <option value="asdfave,ad2010baltika3">2010 · Estonia, Latvia, Lithuania</option>
            <option value="asdfave,ad2010baltika2">2010 · Finland, Denmark, Norway, Sweden</option>
            <option value="asdfave,ad2010baltika1">2010 · Russia, Ukraine, Belarus</option>
            <option value="asdfave,ad2009costaragua">2009 · Costa Rica, Nicaragua</option>
            <option value="asdfave,cuba">2009 · Cuba</option>
            <option value="asdfave,ad2008-india1">2008 · India: Mumbai, Rajasthan</option>
            <option value="asdfave,ad2008-india2">2008 · India: north, central</option>
            <option value="asdfave,india">2008 · India: east, Andamans, south</option>
            <option value="asdfave,mexico,2007">2007 · Mexico</option>
            <option value="asdfave,ad2006japan">2006 · Japan</option>
            <option value="asdfave,ad2006mediterrabia1">2006 · Morocco, Tunisia, Malta</option>
            <option value="asdfave,ad2006mediterrabia2">2006 · Lebanon, Emirates, Oman</option>
            <option value="asdfave,ad2006mediterrabia3">2006 · Jordan, Palisraelistine, France</option>
            <option value="asdfave,germany">2004 · Germany</option>
            <option value="asdfave,italy">2004 · Italy</option>
            <option value="asdfave,ad2003warstanbul2">2003 · Hungary, Romania, Bulgaria, Turkey</option>
            <option value="asdfave,ad2003warstanbul1">2003 · Poland, Czechia, Slovakia, Austria</option>
            <option value="asdfave,ad2001auldalliance">2001 · UK, France</option>
            <option value="asdfave,ad2001mercosur">2001 · Brazil, Argentina, Chile, Uruguay</option>
            <option value="asdfave,ad2000amadeus">2000 · France, Monaco, Italy</option>
            <option value="asdfave,ad1999easyeurope">1999 · Greece, UK, Spain, France</option>
            <option value="asdfave,ad1998cathaysia">1998 · Hong Kong, Thailand, Malaysia, Vietnam, Japan</option>
<!--
            <option value="asdfave,Africa">Africa</option>
            <option value="asdfave,Asia">Asia</option>
            <option value="asdfave,Europe">Europe</option>
            <option value="asdfave,NorthAmerica">Northy America</option>
            <option value="asdfave,SouthAmerica">South America</option>
-->
            <option></option>

        <optgroup label="Who">
            <option value="asdfave,Elise">Elise</option>
            <option value="asdfave,Andrew">Andrew</option>
            <option value="asdfave,Sandra">Sandra</option>
            <option value="asdfave,family">Family</option>
            <option value="asdfave,kotf">Cowboy & Simone</option>
            <option value="asdfave,Jesse">Jesse</option>
            <option></option>

        <optgroup label="Why">
            <option value="asdfave,funny">Funny</option>
            <option value="asdfave,weird">Weird</option>

        <optgroup label="When">
            <option value="asdfave,20112015">2011-2015</option>
            <option value="asdfave,20062010">2006-2010</option>
            <option value="asdfave,20012005">2001-2005</option>
            <option value="asdfave,19952000">1995-2000</option>
            <option></option>

</select>
        
        <button class="k-button" id="update">yep</button>


</div><!-- end menu -->


</div><!-- container -->


    

       <div id="picstest"></div>
        
        <div id="pics"></div>
        <div id="loading">Loading...</div>
      
             
      
        <script type="text/javascript">
		
// Developed by Sam Judson, sam@wackylabs.net
// http://www.wackylabs.net
//
// This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 3.0 Unported License
// http://creativecommons.org/licenses/by-nc-sa/3.0/
  

$(document).ready(function() {

    // perform initial loading
    justifiedLayout.loadData();
    
    $("#update").click(justifiedLayout.loadData);
    
    $("#tags").keyup(function(event){
        if(event.keyCode == 13){
            $("#update").click();
        }
    });
    
    $("#sort").kendoDropDownList({
        change: justifiedLayout.loadData
    });

});

var justifiedLayout = {};

(function(context) {

    var minWidth = 800;
    var minHeight = 800;
  
    var lastWidth = 0;
    var photoArray = null;
    var maxPhotos = 30;
    // total number of images appearing in all previous rows
    var baseLine = 0;

    $(window).resize(function() {

        var nowWidth = $("div#picstest").innerWidth();
        if( nowWidth < minWidth ) return;
        
        // test to see if the window resize is big enough to deserve a reprocess
        if( nowWidth * 1.1 < lastWidth || nowWidth * 0.9 > lastWidth )
        {
            // if so call method
            updateRows();
        }
    });

    context.loadData = function() {
        photoArray = null;
        baseLine = 0;
        maxPhotos = 30;
        $("div#pics").empty();
        $("#loading").show();
        
        var tags = $("#tags").val();
        var sort = $("#sort").val();
        $.getJSON("https://api.flickr.com/services/rest/",
            {
                method: "flickr.photos.search",
                api_key: "d75b34b1afe5da8c8918eba885038682",
				user_id: "75751316@N00",
				tags: tags,
                tag_mode: "all",
                sort: "date-taken-desc",
                extras: "url_n,url_m,url_z,url_l",
                format: "json",
                per_page: 400,
                nojsoncallback: 1
            }, 
            function(data, status) {
                photoArray = data.photos.photo;
                updateRows();
                $("#loading").hide();
            }
        );
    };
  
    var clickHandler = function(photo)
        {
          return function() {
            var url = "https://www.flickr.com/photos/" + photo.owner + "/" + photo.id;
            location.href = url;
          };
        };

    // only call this when either the data is loaded, or the windows resizes by a chunk
    var updateRows = function() {
        lastWidth = $("div#picstest").innerWidth();
        lastWidth = Math.max(lastWidth, minWidth);
        baseLine = 0;
        processPhotos(photoArray);
        $("div.picrow").width(lastWidth);
    };
    
    var processPhotos = function(photos) {
        if (!photos) return;
      
        // divs to contain the images
        var d = $("div#pics");
        if( baseLine === 0 ) {
            d.empty();
        }
        
        // get row width - this is fixed.
        var w = lastWidth;
        
        // initial height - effectively the maximum height +/- 10%;
        var h = Math.max(minHeight,Math.floor(w / 5));
        // margin width
        var border = 5;
        
        // store relative widths of all images (scaled to match estimate height above)
        var ws = [];
        $.each(photos, function(key, val) {
            var wt = parseInt(val.width_n, 10);
            var ht = parseInt(val.height_n, 10);
            if( ht != h ) { wt = Math.floor(wt * (h / ht)); }
            ws.push(wt);
        });
    
        var rowNum = 0;
        var limit = Math.min(maxPhotos, photos.length);
        
        while(baseLine < limit)
        {
            rowNum++;
            // number of images appearing in this row
            var c = 0; 
            // total width of images in this row - including margins
            var tw = 0;
            
            // calculate width of images and number of images to view in this row.
            while( (tw * 1.1 < w) && (baseLine + c < limit))
            {
                tw += ws[baseLine + c++] + border * 2;
            }

            // skip the last row
            if( baseLine + c >= limit ) return;
            
            var d_row = $("<div/>", {"class" : "picrow"});
            d.append(d_row);
            

            // Ratio of actual width of row to total width of images to be used.
            var r = w / tw; 
            
            // image number being processed
            var i = 0;
            // reset total width to be total width of processed images
            tw = 0;
            // new height is not original height * ratio
            var ht = Math.floor(h * r);
            d_row.height(ht + border * 2);

            while( i < c )
            {
                var photo = photos[baseLine + i];
                // Calculate new width based on ratio
                var wt = Math.floor(ws[baseLine + i] * r);
                // add to total width with margins
                tw += wt + border * 2;
              
                // Create image, set src, width, height and margin
                var purl = photo.url_n;
                if( wt > photo.width_n * 1.2 || ht > photo.height_n * 1.2 ) purl = photo.url_m;
                if( wt > photo.width_m * 1.2 || ht > photo.height_m * 1.2 ) purl = photo.url_z;
                if( wt > photo.width_z * 1.2 || ht > photo.height_z * 1.2 ) purl = photo.url_l;
              
                var img = $(
                  '<img/>', 
                  {
                      "class": "photo", 
                      src: purl, 
                      width: wt, 
                      height: ht
                  }).css("margin", border + "px");
              
                img.click(clickHandler(photo));
                d_row.append(img);

                i++;
            }
            
            // set row height to actual height + margins
            baseLine += c;

            // if total width is slightly smaller than 
            // actual div width then add 1 to each 
            // photo width till they match
            i = 0;
            while( tw < w )
            {
                var img1 = d_row.find("img:nth-child(" + (i + 1) + ")");
                img1.width(img1.width() + 1);
                i = (i + 1) % c;
                tw++;
            }
            // if total width is slightly bigger than 
            // actual div width then subtract 1 from each 
            // photo width till they match
            i = 0;
            while( tw > w )
            {
                var img2 = d_row.find("img:nth-child(" + (i + 1) + ")");
                img2.width(img2.width() - 1);
                i = (i + 1) % c;
                tw--;
            }
            
        }
    };

    // levelReached function taken from infiniteScroll jquery plugin
    // https://github.com/holtonma/infini_scroll

    var levelReached = function(){
        // is it low enough to add elements to bottom?
        var pageHeight = Math.max(document.body.scrollHeight ||
        document.body.offsetHeight);
        var viewportHeight = window.innerHeight  ||
        document.documentElement.clientHeight  ||
        document.body.clientHeight || 0;
        var scrollHeight = window.pageYOffset ||
        document.documentElement.scrollTop  ||
        document.body.scrollTop || 0;
        // Trigger for scrolls within 20 pixels from page bottom
        return pageHeight - viewportHeight - scrollHeight < 10;
    };

    var pollLevel = function() {
        if( photoArray && levelReached() )
        {
            maxPhotos = Math.min(maxPhotos+30, 150);
            processPhotos(photoArray);
        }
        setTimeout(pollLevel, 100);
    };
    
    pollLevel();

})(justifiedLayout);

</script>


</body>

</html>
